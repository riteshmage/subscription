<?xml version="1.0"?>
<config>

	<modules>
		<Thycart_Subscription>
			<version>0.1.0</version>
		</Thycart_Subscription>
	</modules>

	<frontend>
		<routers>
			<subscription>
				<use>standard</use>
				<args>
					<module>Thycart_Subscription</module>
					<frontName>subscription</frontName>
				</args>
			</subscription>
			<checkout>
				<args>
					<modules>
						<thycart_subscription before="Mage_Checkout">Thycart_Subscription</thycart_subscription>
					</modules>
				</args>
			</checkout>
		</routers>
		<layout>
			<updates>
				<thycart_subscription>
					<file>subscription.xml</file>
				</thycart_subscription>
			</updates>
		</layout>

	</frontend>

	<admin>
		<routers>
			<admin_subscription>
				<use>admin</use>
				<args>
					<module>Thycart_Subscription</module>
					<frontName>admin_subscription</frontName>
				</args>
			</admin_subscription>
		</routers>		
	</admin>

	<adminhtml>
		<layout>
			<updates>
				<subscription>
					<file>subscription.xml</file>
				</subscription>
			</updates>
		</layout>
	</adminhtml>

	<global>
		<blocks>
			<blk_subscription>
				<class>Thycart_Subscription_Block</class>
			</blk_subscription>
		</blocks>
		<helpers>
			<subscription>
				<class>Thycart_Subscription_Helper</class>
			</subscription>
		</helpers>
		<models>
			<subscription>
				<class>Thycart_Subscription_Model</class>
				<resourceModel>subscription_resource</resourceModel>
			</subscription>
			<subscription_resource>
				<class>Thycart_Subscription_Model_Resource</class>
				<entities>
					<master>
						<table>subscription_master</table>
					</master>
					<unit>
						<table>unit_master</table>
					</unit>
					<subscriptioncustomer>
						<table>subscription_customer</table>
					</subscriptioncustomer>
					<unitproductmapping>
						<table>unit_product_mapping</table>
					</unitproductmapping>
				</entities>
			</subscription_resource>
		</models>
		<resources>
			<subscription_setup>
				<setup>
					<module>Thycart_Subscription</module>
				</setup>
				<connection>
					<use>core_setup</use>
				</connection>
			</subscription_setup>
			<subscription_write>
				<connection>
					<use>core_write</use>
				</connection>
			</subscription_write>
			<subscription_read>
				<connection>
					<use>core_read</use>
				</connection>
			</subscription_read>
		</resources>
		<events>
			<sales_quote_collect_totals_after>
				<observers>
					<set_custom_discount>
						<type>singleton</type>
						<class>Thycart_Subscription_Model_Observer</class>
						<method>setDiscount</method>
					</set_custom_discount>
				</observers>
			</sales_quote_collect_totals_after>
			<checkout_onepage_controller_success_action>
				<observers>
					<successful_subscription>
						<type>singleton</type>
						<class>Thycart_Subscription_Model_Observer</class>
						<method>successfullySubscribed</method>
					</successful_subscription>
				</observers>
			</checkout_onepage_controller_success_action>
		</events>
		<template>
			<email>
				<subscription_template>
					<label>Subscription Template</label>
					<file>subscription_template.html</file>
					<type>html</type>
				</subscription_template>
			</email>
		</template>
	</global>
	<crontab>
		<jobs>
			<subscription>
				<schedule>
					<cron_expr>0 0 * * *</cron_expr>
				</schedule>
				<run><model>subscription/observer::cron</model></run>
			</subscription>
		</jobs>
	</crontab>
</config>